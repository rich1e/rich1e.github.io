---
title: å‰ç«¯è½¯ä»¶ç‰ˆæœ¬å‘å¸ƒæ¢ç´¢
date: 2021-12-07
permalinkPattern: :year/:month/:day/:slug.html
---

# å‰ç«¯è½¯ä»¶ç‰ˆæœ¬å‘å¸ƒæ¢ç´¢

[[toc]]

> è½¯ä»¶ç‰ˆæœ¬å‘å¸ƒæ˜¯ä¸€ä»¶éå¸¸ä¸¥è‚ƒçš„äº‹æƒ…ã€‚å¦‚æœæ²¡æœ‰è‰¯å¥½çš„è§„èŒƒæ ‡å‡†å’Œæ˜“äºä½¿ç”¨çš„æµç¨‹æ§åˆ¶æŠ€æœ¯ï¼Œå°†ä¼šé™·å…¥åœ°ç‹±èˆ¬çš„æŠ˜ç£¨ã€‚è™½ç„¶ä¸ä¼šé©¬ä¸Šæ­»å»ï¼Œä½†ä¹Ÿè¿‡å¾—ä¸å¤ªèˆ’å¿ƒã€‚

ä¸ªäººè®¤ä¸ºï¼Œè½¯ä»¶ç‰ˆæœ¬è¯´æ˜ï¼Œéœ€è¦ç®€æ´æ¸…æ™°æ˜“äºç†è§£ï¼Œå¸®åŠ©ä½¿ç”¨è€…æ›´å¥½çš„äº†è§£è½¯ä»¶æœ¬èº«æä¾›äº†å“ªäº›åŠŸèƒ½ï¼Ÿå¦‚æœåšä¸åˆ°ä»¥ä¸Šå†…å®¹ï¼Œé‚£ä¹ˆè½¯ä»¶å¼€å‘çš„ç›®çš„æ€§å’Œåç»­æ›´æ–°çš„åŠ¨æœºï¼Œå°±æ›´æ˜¾å¾—è‹ç™½æ— åŠ›ã€‚

é¦–å…ˆï¼Œäº†è§£ä¸€ä¸‹è§„èŒƒæ ‡å‡†ã€‚ä»ä¸€å¼€å§‹è®¡åˆ’å¼€å‘è½¯ä»¶æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥å°±æœ‰äº†ä¸€ä¸ªå¼€å‘ç›®å½•ï¼Œè€Œåæ˜¯æ–‡ä»¶å¤¹ã€æ–‡ä»¶å’Œä»£ç ç­‰ç­‰ä¸€å †è½¯ä»¶æ‰€éœ€çš„èµ„æºæ–‡ä»¶ã€‚é¡¹ç›®æ–‡ä»¶ç»“æ„ã€æ–‡ä»¶å‘½åã€ç¼–ç çº¦å®šç­‰ç­‰ï¼Œè¿™äº›éƒ½ä¼šæœ‰ç›¸å…³æ ‡å‡†ã€‚æœ¬æ–‡ä¸»è¦èŠä¸€ä¸‹ä»£ç æäº¤è§„èŒƒï¼Œå› ä¸ºä¸è®ºæ˜¯å“ªç§è½¯ä»¶å¼€å‘ï¼Œè¿™å¥—æ ‡å‡†ç›¸å¯¹éƒ½æ¯”è¾ƒæ™®é€‚ã€‚

## ä»£ç æäº¤è§„èŒƒ [^1] [^2] [^3]

ä»£ç æäº¤è§„èŒƒï¼Œå³ Commit è§„èŒƒã€‚æˆ‘ä¸»è¦ä½¿ç”¨çš„å·¥å…·æ˜¯ï¼š`commitizen`ã€‚è¯¥å·¥å…·æä¾›äº†å¾ˆå¤šåŠŸèƒ½ï¼šçº¦æŸä»£ç æäº¤æ ¼å¼ã€æ ¡éªŒ commit åˆæ³•æ€§ã€äº¤äº’å¼çš„å‘½ä»¤æç¤ºç­‰ç­‰ã€‚éå¸¸å¼ºå¤§ï¼Œè€Œä¸”æ”¯æŒè·¨å¹³å° windows å’Œ mac éƒ½å…¼å®¹ï¼Œä¸€ç›´åœ¨æ›´æ–°ç»´æŠ¤ï¼Œç¤¾åŒºä¹Ÿéå¸¸å¥½ã€‚

è¿™ä¸ªå·¥å…·å¯ä»¥å®šåˆ¶å±äºè‡ªå·±çš„è§„åˆ™é€‚é…å™¨ï¼ˆAdapterï¼‰ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨å…¶ä»–æ¯”è¾ƒæµè¡Œçš„é€‚é…å™¨ã€‚ä¾‹å¦‚ï¼š[cz-conventional-changelog](https://link.zhihu.com/?target=https%3A//github.com/commitizen/cz-conventional-changelog)ã€‚æœ¬æ¬¡æˆ‘æ‰“ç®—åšä¸€ä¸ªè‡ªå·±ç‹¬æœ‰çš„é€‚é…å™¨ï¼Œå› æ­¤å®‰è£… `cz-customizable` ã€‚

```shell
yarn add -D commitizen cz-customizable
```

å®‰è£…å®Œæˆåï¼Œå°†ä¸‹é¢çš„ä»£ç æ·»åŠ åˆ° `package.json` ã€‚

```json
"config": {
  "commitizen": {
  	"path": "./node_modules/cz-customizable"
  }
}
```

åˆ›å»º `.cz-config.js`

::: details ç‚¹å‡»æŸ¥çœ‹ä»£ç 

```javascript
/*
 * @Author: gongyuqi
 * @Date: 2021-06-03 18:01:41
 * @LastEditTime: 2021-06-03 18:15:07
 * @FilePath: /openpl/.cz-config.js
 */
module.exports = {
  // type ç±»å‹ï¼ˆå®šä¹‰ä¹‹åï¼Œå¯é€šè¿‡ä¸Šä¸‹é”®é€‰æ‹©ï¼‰
  types: [
    { value: ":sparkles: feat", name: "âœ¨ æ–°å¢åŠŸèƒ½" },
    { value: ":bug: fix", name: "ğŸ› ä¿®å¤ bug" },
    { value: ":memo: docs", name: "ğŸ“ æ–‡æ¡£å˜æ›´" },
    { value: ":bulb: comments", name: "ğŸ’¡ æ·»åŠ æ³¨é‡Š" },
    { value: ":lipstick: style", name: "ğŸ’„ ä»£ç æ ¼å¼ï¼ˆä¸å½±å“åŠŸèƒ½ï¼Œä¾‹å¦‚ç©ºæ ¼ã€åˆ†å·ç­‰æ ¼å¼ä¿®æ­£ï¼‰" },
    { value: ":recycle: refactor", name: "â™»ï¸ ä»£ç é‡æ„ï¼ˆä¸åŒ…æ‹¬ bug ä¿®å¤ã€åŠŸèƒ½æ–°å¢ï¼‰" },
    { value: ":zap:perf", name: "âš¡ï¸ æ€§èƒ½ä¼˜åŒ–" },
    { value: ":white_check_mark: test", name: "âœ… æ·»åŠ ã€ä¿®æ”¹æµ‹è¯•ç”¨ä¾‹" },
    { value: ":construction_worker: build", name: "ğŸ‘· æ„å»ºæµç¨‹ã€å¤–éƒ¨ä¾èµ–å˜æ›´ï¼ˆå¦‚ä¿®æ”¹ npm åŒ…ã€ä¿®æ”¹ webpack é…ç½®ç­‰ï¼‰" },
    { value: ":wrench: ci", name: "ğŸ”§ ä¿®æ”¹ CI é…ç½®" },
    { value: ":arrow_up: upgrade", name: "â¬†ï¸ å‡çº§ä¾èµ–åŒ…" },
    { value: ":arrow_down: downgrade", name: "â¬‡ï¸ é™çº§ä¾èµ–åŒ…" },
    { value: ":rocket: chore", name: "ğŸš€ å¯¹æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å’Œåº“çš„æ›´æ”¹ï¼ˆä¸å½±å“æºæ–‡ä»¶ã€æµ‹è¯•ç”¨ä¾‹ï¼‰" },
    { value: ":bookmark: release", name: "ğŸ”– ç‰ˆæœ¬å‘å¸ƒæˆ–åˆ›å»ºç‰ˆæœ¬æ ‡ç­¾" },
    { value: ":truck: rename", name: "ğŸšš ä»£ç ç§»åŠ¨æˆ–è€…é‡å‘½å" },
    { value: ":fire: remove", name: "ğŸ”¥ ä»£ç åˆ é™¤" },
    { value: ":rewind: revert", name: "âªï¸ å›æ»š commit" },
  ],

  // scope ç±»å‹ï¼ˆå®šä¹‰ä¹‹åï¼Œå¯é€šè¿‡ä¸Šä¸‹é”®é€‰æ‹©ï¼‰
  scopes: [
    ["components", "ç»„ä»¶ç›¸å…³"],
    ["api", "api ç›¸å…³"],
    ["config", "é…ç½®ç›¸å…³"],
    ["hooks", "hook ç›¸å…³"],
    ["utils", "utils ç›¸å…³"],
    ["styles", "æ ·å¼ç›¸å…³"],
    ["deps", "é¡¹ç›®ä¾èµ–"],
    ["auth", "å¯¹ auth ä¿®æ”¹"],
    ["ant-design-vue", "å¯¹ ant-design-vue çš„è°ƒæ•´"],
    ["typescript", "å®Œå–„ typescript å®šä¹‰"],
    ["other", "å…¶ä»–ä¿®æ”¹"],
    // å¦‚æœé€‰æ‹© customï¼Œåé¢ä¼šè®©ä½ å†è¾“å…¥ä¸€ä¸ªè‡ªå®šä¹‰çš„ scopeã€‚
    // ä¹Ÿå¯ä»¥ä¸è®¾ç½®æ­¤é¡¹ï¼ŒæŠŠåé¢çš„ allowCustomScopes è®¾ç½®ä¸º true
    ["custom", "ä»¥ä¸Šéƒ½ä¸æ˜¯ï¼Ÿæˆ‘è¦è‡ªå®šä¹‰"],
  ].map(([value, description]) => {
    return {
      value,
      name: `${value}(${description})`,
    };
  }),

  // æ˜¯å¦å…è®¸è‡ªå®šä¹‰å¡«å†™ scopeï¼Œåœ¨ scope é€‰æ‹©çš„æ—¶å€™ï¼Œä¼šæœ‰ empty å’Œ custom å¯ä»¥é€‰æ‹©ã€‚
  // allowCustomScopes: true,

  // allowTicketNumber: false,
  // isTicketNumberRequired: false,
  // ticketNumberPrefix: 'TICKET-',
  // ticketNumberRegExp: '\\d{1,5}',

  // é’ˆå¯¹æ¯ä¸€ä¸ª type å»å®šä¹‰å¯¹åº”çš„ scopesï¼Œä¾‹å¦‚ fix
  /*
  scopeOverrides: {
    fix: [
      { name: 'merge' },
      { name: 'style' },
      { name: 'e2eTest' },
      { name: 'unitTest' }
    ]
  },
  */

  // äº¤äº’æç¤ºä¿¡æ¯
  messages: {
    type: "ç¡®ä¿æœ¬æ¬¡æäº¤éµå¾ªå¼€å‘è§„èŒƒï¼\né€‰æ‹©ä½ è¦æäº¤çš„ç±»å‹ï¼š",
    scope: "\né€‰æ‹©ä¸€ä¸ª scopeï¼ˆå¯é€‰ï¼‰ï¼š",
    // é€‰æ‹© scope: custom æ—¶ä¼šå‡ºä¸‹é¢çš„æç¤º
    customScope: "è¯·è¾“å…¥è‡ªå®šä¹‰çš„ scopeï¼š",
    subject: "å¡«å†™ç®€çŸ­ç²¾ç‚¼çš„å˜æ›´æè¿°ï¼š\n",
    body: 'å¡«å†™æ›´åŠ è¯¦ç»†çš„å˜æ›´æè¿°ï¼ˆå¯é€‰ï¼‰ã€‚ä½¿ç”¨ "|" æ¢è¡Œï¼š\n',
    breaking: "åˆ—ä¸¾éå…¼å®¹æ€§é‡å¤§çš„å˜æ›´ï¼ˆå¯é€‰ï¼‰ï¼š\n",
    footer: "åˆ—ä¸¾å‡ºæ‰€æœ‰å˜æ›´çš„ ISSUES CLOSEDï¼ˆå¯é€‰ï¼‰ã€‚ ä¾‹å¦‚: #31, #34ï¼š\n",
    confirmCommit: "ç¡®è®¤æäº¤ï¼Ÿ",
  },

  // è®¾ç½®åªæœ‰ type é€‰æ‹©äº† feat æˆ– fixï¼Œæ‰è¯¢é—® breaking message
  allowBreakingChanges: ["feat", "fix"],

  // è·³è¿‡è¦è¯¢é—®çš„æ­¥éª¤
  skipQuestions: ["body", "footer"],

  breaklineChar: "|", // æ”¯æŒ body å’Œ footer
  // footerPrefix : 'ISSUES CLOSED:'
  // askForBreakingChangeFirst : true,
  // subject é™åˆ¶é•¿åº¦
  subjectLimit: 100,
};
```

:::

æ ¡éªŒ `commit message` çš„æœ€ä½³æ–¹å¼æ˜¯ç»“åˆ `git hook`ï¼Œå› æ­¤éœ€è¦å®‰è£… `Commitlint` å’Œ `Husky`ã€‚ç”±äºè§„åˆ™é‡Œé¢ä½¿ç”¨äº† `emoji` ï¼Œå› æ­¤è¿˜éœ€è¦æœ‰å®‰è£… `commitlint-config-gitmoji`ã€‚

```shell
yarn add -D @commitlint/cli commitlint-config-gitmoji
```

åˆ›å»º `commitlint.config.js`

```javascript
module.exports = {
  extends: ["gitmoji"],
};
```

## ä»£ç æ£€æŸ¥æ–¹å¼ [^4] [^5]

å¾…å®Œå–„

## ä»£ç ç‰ˆæœ¬æ§åˆ¶ [^6]

```shell
yarn add -D standard-version
```

åˆ›å»º `.versionrc.js`

```javascript
module.exports = {
  header: "# åµŒå…¥å¼é‡‘èå¼€æ”¾å¹³å°-æ›´æ–°æ—¥å¿— \n\n ",
  types: [
    { type: "feat", section: "âœ¨ Features | æ–°åŠŸèƒ½" },
    { type: "fix", section: "ğŸ› Bug Fixes | Bug ä¿®å¤" },
    { type: "init", section: "ğŸ‰ Init | åˆå§‹åŒ–" },
    { type: "docs", section: "âœï¸ Documentation | æ–‡æ¡£" },
    { type: "style", section: "ğŸ’„ Styles | é£æ ¼" },
    { type: "refactor", section: "â™»ï¸ Code Refactoring | ä»£ç é‡æ„" },
    { type: "perf", section: "âš¡ Performance Improvements | æ€§èƒ½ä¼˜åŒ–" },
    { type: "test", section: "âœ… Tests | æµ‹è¯•" },
    { type: "revert", section: "âª Revert | å›é€€" },
    { type: "build", section: "ğŸ“¦â€ Build System | æ‰“åŒ…æ„å»º" },
    { type: "chore", section: "ğŸš€ Chore | æ„å»º/å·¥ç¨‹ä¾èµ–/å·¥å…·" },
    { type: "ci", section: "ğŸ‘· Continuous Integration | CI é…ç½®" },
  ],
  commitUrlFormat: "https://example.com/{{repository}}/commit/{{hash}}",
  releaseCommitMessageFormat: ":rocket: chore(publish): v{{currentTag}} ç‰ˆæœ¬å‘å¸ƒ",
};
```

[^1]: [commit è§„èŒƒ+commitlint+CHANGELOG è‡ªåŠ¨ç”Ÿæˆä¸€æ¡é¾™æœåŠ¡](https://juejin.cn/post/6934292467160514567)
[^2]: [Conventional Commits](https://www.conventionalcommits.org/zh-hans/v1.0.0/)
[^3]: [ant-design è½®å€¼è§„åˆ™å’Œç‰ˆæœ¬å‘å¸ƒæµç¨‹](https://github.com/ant-design/ant-design/wiki/%E8%BD%AE%E5%80%BC%E8%A7%84%E5%88%99%E5%92%8C%E7%89%88%E6%9C%AC%E5%8F%91%E5%B8%83%E6%B5%81%E7%A8%8B)
[^4]: [è§„èŒƒåŒ– Git åˆä½œæµç¨‹](https://xiaojun1994.top/posts/fa3efcda.html)
[^5]: [Gitmoji Commit Workflow å®Œå…¨æŒ‡å—](https://www.yuque.com/arvinxx-fe/workflow/gitmoji-commit-workflow)
[^6]: [ä¼˜åŒ–å‰ç«¯å·¥ä½œæµï¼šä¸‰ã€ä½¿ç”¨ standard-version ç®¡ç† ChangeLog å’Œ Version](https://www.jianshu.com/p/bfc96f9a7939)
